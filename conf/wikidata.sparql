# Get administrative areas in North Rhine-Westphalia with German labels
SELECT DISTINCT
?item
?itemLabel
?partOf
?gnd
?dissolutionDate
(group_concat(distinct ?hasPart; separator = ", ") as ?parts)
WHERE {
           { ?item wdt:P131* wd:Q1198 . }
      UNION
           { ?item p:P131 [ ps:P131 wd:Q1198 ] . }
           { ?item p:P31 [ ps:P31 wd:Q829277 ] . } # Regierungsbezirk in NRW
       UNION
           { ?item p:P31 [ ps:P31 wd:Q106658 ] . } # Landkreis
       UNION
           { ?item p:P31 [ ps:P31 wd:Q262166 ] . } # Gemeinde
       UNION
           { ?item p:P31 [ ps:P31 wd:Q22865 ] . } # kreisfreie Stadt
       UNION
           { ?item p:P31 [ ps:P31 wd:Q253019 ]. } # Ortsteil
       UNION
           { ?item p:P31 [ ps:P31 wd:Q1852178 ] . } # Stadteil von Düsseldorf
       UNION
           { ?item p:P31 [ ps:P31 wd:Q15632166 ] . } # Stadtteil von Köln
       UNION
           { ?item wdt:P31/wdt:P279*  wd:Q4286337 } # Stadtbezirk, für Geocache auskommentieren
       UNION
           { ?item p:P31 [ ps:P31 wd:Q4286337 ] . }
  SERVICE wikibase:label {  bd:serviceParam wikibase:language "de" }
  OPTIONAL { ?item wdt:P227 ?gnd }
  OPTIONAL { ?item wdt:P576 ?dissolutionDate }
  OPTIONAL { ?item wdt:P150 ?hasPart . }
  OPTIONAL { ?item wdt:P131 ?partOf }
}

GROUP BY ?item ?itemLabel ?partOf ?gnd ?dissolutionDate